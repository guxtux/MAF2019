\input{../Preambulos/preambulo_materiales}
\title{Transformada de Laplace} \vspace{-3ex}
\author{M. en C. Gustavo Contreras Mayén}
\date{ }
\newcommand{\Cancel}[2][black]{{\color{#1}\cancel{\color{black}#2}}}
\begin{document}
\vspace{-4cm}
\maketitle
\fontsize{14}{14}\selectfont
\tableofcontents
\newpage

%Ref. Penney. Cp. 7 Ecs. Diferenciales

\section{La Transformada de Laplace}
\subsection{Definiciones}

Dada una función $f(t)$ definida para toda $t \geq 0$, \emph{la transformada de Laplace} de $f$ es la función $F$ definida por:
\begin{align*}
F(s) = \mathcal{L} \left\{ f(t) \right\} = \scaleint{5ex}_{\bs 0}^{\infty} \exp(-s \, t) \, f(t) \dd{t}
\end{align*}
para todo valor de $s$ en los cuales la integral impropia converge.
\par
Si $F(s)$ es la transformada de Laplace de alguna función continua $f(t)$,  entonces $f(t)$ está determinada de manera única.
\par
Si $F(s) = \mathcal{L} \left\{ f(t) \right\}$, entonces se llama $f(t)$ \emph{la transformada inversa de Laplace}:
\begin{align*}
f(t) = \mathcal{L}^{-1} \left\{ F(s) \right\}
\end{align*}

Si las funciones $f$, $\ptilde{f}$, $\stilde{f}, \ldots, \ntilde{f}{n}$ son continuas y suaves en tramos para $t \geq 0$, y que cada una es de orden exponencial, con los mismos valores de $M$ y $c$. Entonces, la transformada de la derivada de orden $n$ de $f$ existe cuando $s > c$ y:
\begin{align*}
\mathcal{L} \left\{ \ntilde{f}{n} (t) \right\} = s^{n} \, F(s) - s^{s-1} f(0) - s^{n-2} \, \ptilde{f}(0) - \ldots s \, \ntilde{f}{n-2}(0) - \ntilde{f}{n-1}(0)
\end{align*}

\section{Resonancia y factores cuadráticos repetidos}
\subsection{Transformadas de interés}

Las siguientes dos transformadas inversas de Laplace son útiles para invertir fracciones parciales al caso de factores cuadráticos repetidos:
\begin{align}
L^{-1} \left\{ \dfrac{1}{(s^{2} + k^{2})} \right\} &= \dfrac{1}{ k} \, \sin k \, t \label{eq:ecuacion_07_03_16} \\[0.5em]
L^{-1} \left\{ \dfrac{1}{(s^{2} + k^{2})^{2}} \right\} &= \dfrac{1}{2 \, k^{3}} \, (\sin k \, t - k \, t \, \cos k \, t) \label{eq:ecuacion_07_03_17}
\end{align}

Debido a la presencia de los términos $t \, \sin k \, t$ y $t \, \cos k \, t$ en las ecs. (\ref{eq:ecuacion_07_03_16}) y (\ref{eq:ecuacion_07_03_17}), un factor cuadrático repetido comúnmente indica la presencia del fenómeno de resonancia en un sistema mecánico no amortiguado o en un sistema eléctrico.

\subsection{Primer ejemplo. Oscilador sin fricción.}

Resuelve el siguiente problema con valores iniciales:
\begin{align*}
\stilde{x} + \omega_{0}^{2} \, x = F_{0} \, \sin \omega \, t, \hspace{1cm} x(0) = \ptilde{x} (0) = 0
\end{align*}
que determinan las oscilaciones forzadas no amortiguadas de una masa sujeta a un resorte.

Aplicando la transformada de Laplace a la ED, se obtiene la ecuación:
\begin{align*}
s^{2} \, X(s) + \omega^{2} \, X(s) = \dfrac{F_{0} \, \omega}{s^{2} + \omega^{2}}
\end{align*}
Recordemos la notación $X(s)$, representa la transformada de Laplace de la función $x(t)$.
\par
Por lo que al despejar $X(s)$, tenemos que:
\begin{align*}
X(s) = \dfrac{F_{0} \, \omega}{(s^{2} + \omega^{2})(s^{2} + \omega_{0}^{2})}
\end{align*}

Por lo que habrá que revisar los dos casos:
\begin{enumerate}
\item $\omega \neq \omega_{0}$.
\item $\omega = \omega_{0}$.
\end{enumerate}

\subsection*{Caso $\omega \neq \omega_{0}$.}

Si $\omega \neq \omega_{0}$, se encuentra que:
\begin{align*}
X(s) = \dfrac{F_{0} \, \omega}{\omega^{2} - \omega_{0}^{2}} \, \left( \dfrac{1}{s^{2}+ \omega_{0}^{2}} - \dfrac{1}{s^{2} + \omega^{2}} \right)
\end{align*}
De esta manera al aplicar la transformada inversa de Laplace, ec. (\ref{eq:ecuacion_07_03_16}), se concluye que la solución es:
\begin{align*}
x(t) = \dfrac{F_{0} \, \omega}{\omega^{2} - \omega_{0}^{2}} \left( \dfrac{1}{\omega_{0}} \sin \omega_{0} \, t - \dfrac{1}{\omega} \, \sin \omega \, t \right)
\end{align*}

\subsection*{Caso $\omega = \omega_{0}$.}

Pero si $\omega = \omega_{0}$, se tiene que:
\begin{align*}
X(s) = \dfrac{F_{0} \, \omega_{0}}{(s^{2} + \omega^{2})^{2}}
\end{align*}
Aplicando la transformada inversa de Laplace, la ec. (\ref{eq:ecuacion_07_03_17}) obtenemos la solución de resonancia:
\begin{align}
x(t) = \dfrac{F_{0}}{2 \, \omega_{0}^{2}} \, (\sin \omega_{0} \, t - \omega_{0} \, t \, \cos \omega_{0} \, t )
\label{eq:ecuacion_07_03_18}
\end{align}

Proporcionando los valores $F_{0} = 1$ y $\omega = 0.5$ y graficando la solución, se tiene la figura (\ref{fig_figura_07_03_04}), en donde podemos ver la solución de resonancia y las curvas envolventes.
\begin{figure}[H]
    \centering
    \includegraphics[scale=1]{Imagenes/sist_masa_resorte_resonancia_plot_01.eps}
    \caption{La solución de resonancia junto con sus curvas envolventes.}
    \label{fig_figura_07_03_04}
\end{figure}

La curva solución definida por la ec. (\ref{eq:ecuacion_07_03_18}) oscila una y otra vez, como vemos en la figura (\ref{fig_figura_07_03_04}) entre dos \enquote{rectas envolventes}: $x = \pm \, C(t)$, que se obtienen al escribir la ec. (\ref{eq:ecuacion_07_03_18}) en la forma
\begin{align*}
x(t) =  A(t) \, \cos \omega_{0} \, t +  B(t) \, \sin \omega_{0 \, t}
\end{align*}

Definiendo entonces la usual \enquote{amplitud}:
\begin{align*}
C = \sqrt{A^{2} +  B^{2}}
\end{align*}
En este caso se encuentra que:
\begin{align*}
C(t) = \dfrac{F_{0}}{2 \, \omega_{0}^{2}} \, \sqrt{\omega_{0}^{2} \, t^{2} + 1}
\end{align*}

\subsection{Segundo ejemplo. Oscilador amortiguado.}

Con un sistema masa resorte amortiguador, considera los valores de $m = 1$, $k = 9.04$, $c= 0.4$ y $F(t) =  6 \, \exp(-t/5) \, \cos 3 \, t$.

Con las condiciones iniciales:
\begin{align*}
x(0) = \ptilde{x}(0) = 0
\end{align*}

Puntos a resolver:
\begin{enumerate}
\item Resuelve el problema para obtener el desplazamiento $x(t)$.
\item ¿Cuál es el valor máximo de la amplitud?
\item Grafica el desplazamiento $x(t)$ y discute tus resultados.
\end{enumerate}

Partimos de la siguiente EDO:
\begin{align*}
m \, \stilde{x} + c \, \ptilde{x} + k \, x = F(t)
\end{align*}

Con los valores señalados en el enunciado, tenemos la EDO:
\begin{align*}
\stilde{x} + 0.4 \, \ptilde{x} + 9.04 \, x = 6 \, \exp\left( -\dfrac{t}{5}\right) \, \cos 3 \, t
\end{align*}
Con las condiciones iniciales:
\begin{align*}
x(0) = \ptilde{x}(0) = 0
\end{align*}

Aplicamos la transformada de Laplace en ambos lados de la EDO:
\begin{align*}
L \big[\stilde{x}\big] &+ L\big[0.4 \, \ptilde{x}\big] + L \big[9.04 \, x\big] = [0.5em]
=& L \left[ 6 \, \exp \left( -\dfrac{t}{5}\right) \, \cos 3 \, t \right]
\end{align*}

Que al aplicar las propiedades de la TL revisadas en el material de trabajo, obtenemos lo siguiente:
\begin{eqnarray*}
L \big[\stilde{x}\big] &=& s^{2} \, X(s) - s \, f(0) - \ptilde{f}(0) \\[0.5em] 
L \big[0.4 \, \ptilde{x}\big] &=& 0. 4 \big( s \, X(s) - f(0)\big) \\[0.5em] 
L \big[9.04 \, x\big] &=& 9.04 \, X(s) \\[0.5em]
L \left[ 6 \, \exp \left( -\dfrac{t}{5}\right) \, \cos 3 \, t \right] &=& 6 \, L \left[\exp \left( -\dfrac{t}{5}\right) \, \cos 3 \, t \right] \\[0.5em] 
&=& 6 \left( \dfrac{s - (-1/5)}{\big[s - 1/5\big]^{2} + 3^{2}} \right) \\[0.5em] 
&=& \dfrac{6 \, (s + 1/5)}{9 + (s + 1/5)^{2}}
\end{eqnarray*}

Ocupando las condiciones iniciales:
\begin{align*}
x(0) = \ptilde{x}(0) = 0
\end{align*}
Tenemos que la ecuación es:
\begin{align*}
s^{2} \, X(s) + 0.4 \, s \, X(s) + 9.04 \, X(s) = \dfrac{6 \, (s + 1/5)}{9 + (s + 1/5)^{2}}
\end{align*}

Que al ordenar los términos para despejar $X(s)$, obtenemos la ecuación algebraica en $X(s)$:
\begin{align*}
X(s) = \dfrac{6 \, (s + 1/5)}{\big[s^{2} + 0.4 \, s + 9.04\big] \big[9 + (s + 1/5)^{2}\big]}
\end{align*}
Ahora debemos de aplicar la transformada inversa de Laplace para obtener la solución $x(t)$. De nuevo ocupamos las propiedades de la transformada inversa de Laplace:

El resultado que se obtiene es:
\begin{align*}
x(t) = t \, \exp (-t/5)
\end{align*}
Con lo que hemos resuelto el primer inciso del problema.

Para obtener el valor máximo de la función $x(t)$, aplicamos lo que ya sabemos de Cálculo I:  obtenemos la derivada de primer orden con respecto a $t$, para encontrar las raíces (en qué punto(s) se anula).
\begin{align*}
\ptilde{x}(t) = 0
\end{align*}
La derivada de la solución es:
\begin{align*}
\ptilde{x}(t) = \exp(-t/5) - \dfrac{t}{5} \, \exp(-t/5) 
\end{align*}

Que al hacer igual a cero, se tiene:
\begin{align*}
\exp(-t/5) - \dfrac{t}{5} \, \exp(-t/5) = 0
\end{align*}

Entonces la(s) raíz(ces) es(serán):
\begin{eqnarray*}
5 \, \exp(-t/5) - t \, \exp(-t/5) &=& 0  \\[0.5em] 
\exp(-t/5) (5 - t) &=& 0 \\[0.5em] 
(5 - t) &=& 0 \\[0.5em] 
t &=& 5
\end{eqnarray*}

Al derivar nuevamente $x(t)$ y evaluar la segunda derivada con la raíz encontrada, veremos cómo es el signo de ésta:
\begin{align*}
\stilde{x}(t) = -\dfrac{2}{5} \, \exp(-t/5) + \dfrac{1}{25} \, \exp(-t/5) \, t
\end{align*}

Que al evaluar en la raíz $t = 5$, nos devuelve: 
\begin{align*}
\stilde{x}(t=5) = - \dfrac{1}{5 \, e} < 0
\end{align*}

Por lo que tenemos el máximo de la función en $t = 5$. Ahora evaluamos la raíz en $x(t)$, y obtenemos:
\begin{align*}
x(t=5) &= 5 \, \exp (-5/5) = [0.5em]
&= \dfrac{5}{e}
\end{align*}
Que representa el valor máximo de la amplitud de la función $x(t)$.  Ya hemos resuelto el segundo inciso.

Ocupamos cualquier programa para graficar la función $x(t)$, puede ser directamente con \LaTeX, \emph{Mathematica}, \emph{MatLab}, o incluso usando programación con \texttt{python}.

La gráfica que describe la posición de la masa con respecto al tiempo, es:
\begin{figure}
    \centering
    \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_01.eps}
    \caption{Solución de $x(t)$ vs $t$}
\end{figure}

Vemos que hay un intervalo en donde se presenta un incremento de la amplitud, se alcanza el máximo de la misma en $t = 5$, para luego ir disminuyendo conforme avanza el tiempo. Podemos hacer un estudio adicional para encontrar más información.
\par
Es posible determinar una curva que \enquote{rodea} a la solución $x(t)$ , para determinar la curva, podemos ocupar los valores en cada cresta de $x(t)$, de tal forma que si tomamos el valor absoluto, tendremos el doble de puntos y con ello, mejorar la aproximación de la curva.

Al graficar la función $\abs{x(t)}$, tendremos:
\begin{figure}[H]
    \centering
    \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_02.eps}
    \caption{Al tomar el valor absoluto, se tendrán más puntos para la aproximación.}
\end{figure}

Como contamos ya con un conjunto mayor de puntos, podemos ocupar su valor y realizar un análisis de mínimos cuadrados y obtener la expresión de la curva:
\begin{figure}[H]
    \centering
    \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_03.eps}
    \caption{La curva en azul es la envolvente de $x(t)$.}
\end{figure}

Al ser $x(t)$ simétrica con respecto a $y = 0$, la curva envolvente para valores negativos, tendrá un signo negativo con respecto a los valores positivos.
\begin{figure}[H]
    \centering
    \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_04.eps}
    \caption{Las curvas envolventes de $x(t)$.}
\end{figure}


\begin{figure}[H]
    \centering
    \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_05.eps}
    \caption{Las curvas envolventes de $x(t)$ como función de $t$.}
\end{figure}


% \section{Masas acopladas}
% \subsection{Sistema de masas}

% El enunciado del ejercicio nos indica que: Dos masas, $m_{1}$ y $m_{2}$, están unidas a dos resortes, $A$ y $B$, de masa insignificante cuyas constantes de resorte son $k_{1}$ y $k_{2}$, respectivamente, los resortes se fijan como se ve en la figura (\ref{fig:figura_dos_masas_01}).

% \begin{figure}
%     \centering
%     \includegraphics[scale=0.35]{Imagenes/Ejercicio_Dos_Masas_01.eps}
%     \caption{El sistema de dos masas acopladas mediante resortes.}
%     \label{fig:figura_dos_masas_01}
% \end{figure}

% Sean $x_{1}(t)$ y $x_{2}(t)$ los desplazamientos verticales de las masas respecto a sus posiciones de equilibrio. Cuando el sistema está en movimiento, el resorte $B$ está sujeto a elongación y compresión;
% por lo que su elongación neta es $x_{2} - x_{1}$.
% \par
% Por tanto, se deduce de la ley de Hooke que los resortes $A$ y $B$ ejercen fuerzas $-k_{1} \, x_{1}$ y $k_{2} (x_{2} - x_{1})$, respectivamente, en $m_{1}$. Si ninguna fuerza externa se aplica al sistema y si ninguna fuerza de amortiguamiento está presente, entonces la fuerza neta en $m_{1}$ es:
% \begin{align*}
% -k_{1} \, x_{1} + k_{2} (x_{2} - x_{1})
% \end{align*}


% \begin{figure}
%     \centering
%     \includegraphics[scale=0.35]{Imagenes/Ejercicio_Dos_Masas_02.eps}
%     \caption{El sistema en reposo, en movimiento y las fuerzas.}
%     \label{fig:figura_dos_masas_02}
% \end{figure}

% Por la segunda ley de Newton podemos escribir:
% \begin{align*}
% m_{1} \, \dv[2]{x_{1}}{t} = - k_{1} \, x_{1} + k_{2} (x_{2} - x_{1})
% \end{align*}
% De manera análoga, la fuerza neta ejercida en la masa $m_{2}$ se debe solo a la elongación neta de $B$. Es decir, $-k_{2} (x_{2} - x_{1})$. Por lo que:
% \begin{align*}
% m_{2} \, \dv[2]{x_{2}}{t} = - k_{2} \, (x_{2} - x_{1})
% \end{align*}

% Tenemos entonces un sistema acoplado: el sistema de EDO que determina el movimiento de las masas es:
% \begin{align*}
% m_{1} \, \stilde{x}_{1} &= - k_{1} \, x_{1} + k_{2} (x_{2} - x_{1}) [0.5em]
% m_{2} \, \stilde{x}_{2} &= - k_{2} \, (x_{2} - x_{1})
% \end{align*}

% \textbf{Resuelve el sistema anterior}, considerando que: $k_{1} = 6$, $k_{2} = 4$, $m_{1} = m_{2} = 1$ y que las masas comienzan a moverse desde sus posiciones de equilibrio con velocidades unitarias opuestas.

% Se tiene el siguiente sistema:
% \begin{table}
% \begin{tabular}{l l l l l }
% $\stilde{x}_{1}$ & $+ 10 \, x_{1}$ &  & $- 4 \, x_{2}$ & $= 0$ [0.5em]
%  & $-4 \, x_{1}$ & $+\stilde{x}_{2}$ & $+ 4 \, x_{2}$ & $=0$
% \end{tabular}
% \end{table}
% sujeta a 
% \begin{align*}
% x_{1}(0) = 0, \hspace{0.3cm} \ptilde{x}_{1}(0) = 1, \hspace{0.3cm} x_{2}(0) = 0, \hspace{0.3cm} \ptilde{x}_{2}(0) = -1
% \end{align*}

% Se aplica la transformada de Laplace en cada ecuación para obtener: 
% \begin{align*}
% s^{2} \, X_{1}(s) {-} s \, x_{1}(0) {-} \ptilde{x}_{1}(0) {+} 10 \, X_{1}(s) {-} 4 \, X_{2}(s) = 0 [0.5em]
% - 4 \, X_{1}(s) {+} s^{2} \, X_{2}(s) {-} s \, x_{2}(0) {-} \ptilde{x}_{2}(0) {+} 4 \, X_{2}(s) = 0
% \end{align*}
% donde $X_{1}(s) = L \big[x_{1} (t)\big]$ y $X_{2}(s) = L \big[x_{2} (t)\big]$, respectivamente.

% El sistema anterior es equivalente a:
% \begin{table}
% \begin{tabular}{r r l }
% $(s^{2} + 10) \, X_{1}(s)-$ & $4 \, X_{2}(s)$ & $=1$ [0.5em]
% $-4 \, X_{1}(s)+$ &$(s^{2} + 4) \, X_{2}(s)$ & $=-1$
% \end{tabular}
% \end{table}


% Resolviendo para $X_{1}(s)$, con fracciones parciales:
% \begin{align*}
% X_{1}(s) = \dfrac{s^{2}}{(s^{2} + 2)(s^{2} + 12)} = - \dfrac{1/5}{s^{2} + 2} + \dfrac{6/5}{s^{2} + 12}
% \end{align*}
% Por lo que podemos ahora aplicar la transformada inversa de Laplace para obtener el desplazamiento de $x_{1}$:
% \begin{eqnarray*}
% x_{1}(t) &=& \! -\dfrac{1}{5 \sqrt{2}} L^{-1} \left[ \dfrac{\sqrt{2}}{s^{2} + 2} \right] {+} \dfrac{6}{5 \sqrt{12}} \, L^{-1} \left[ \dfrac{\sqrt{12}}{s^{2} + 12} \right] [0.5em] 
% &=& - \dfrac{\sqrt{2}}{10} \, \sin \sqrt{2} \, t + \dfrac{\sqrt{3}}{5} \, \sin 2 \, \sqrt{3} \, t
% \end{eqnarray*}

% Resolviendo para $X_{2}(s)$: al sustituir la expresión para $X_{1}(s)$ en la primera ecuación del sistema, se obtiene:
% \begin{align*}
% X_{2}(s) = - \dfrac{s^{2} + 6}{(s^{2} + 2)(s^{2} + 12)} = - \dfrac{2/5}{s^{2} + 2} - \dfrac{3/5}{s^{2} + 12}
% \end{align*}
% De igual manera, aplicamos la transformada inversa de Laplace para obtener $x_{2}(t)$.

% Aplicando la transformada inversa
% \begin{eqnarray*}
% x_{2}(t) &=& \! -\dfrac{2}{5 \sqrt{2}} L^{-1} \left[ \dfrac{\sqrt{2}}{s^{2} + 2} \right] {-} \dfrac{3}{5 \sqrt{12}} L^{-1} \left[ \dfrac{\sqrt{12}}{s^{2} + 12} \right] [0.5em] 
% &=& - \dfrac{\sqrt{2}}{5} \, \sin \sqrt{2} \, t - \dfrac{\sqrt{3}}{10} \, \sin 2 \, \sqrt{3} \, t
% \end{eqnarray*}

% La solución al sistema acoplado es:
% \begin{align*}
% x_{1}(t) &= - \dfrac{\sqrt{2}}{10} \, \sin \sqrt{2} \, t + \dfrac{\sqrt{3}}{5} \, \sin 2 \, \sqrt{3} \, t [0.5em]
% x_{2}(t) &= - \dfrac{\sqrt{2}}{5} \, \sin \sqrt{2} \, t - \dfrac{\sqrt{3}}{10} \, \sin 2 \, \sqrt{3} \, t
% \end{align*}

% Conociendo las soluciones $x_{1}(t)$ y $x_{2}(t)$, ahora podemos presentar una gráfica de las funciones, como se puede ver en la siguiente figura (\ref{fig:plot_dos_masas_01}):
% \begin{figure}
%     \centering
%     \includegraphics[scale=1]{Imagenes/Ejercicio_masas_acopladas_01.eps}
%     \caption{Movimiento de las masas $m_{1}$ y $m_{2}$.}
%     \label{fig:plot_dos_masas_01}
% \end{figure}


% \section{Usando \texttt{Mathematica}}
% \frame{\tableofcontents[currentsection, hideothersubsections]}
% \subsection{Primer ejercicio resonancia}

% 
% Usando paquetería para resolver}
% A continuación resolveremos los mismos ejercicios ocupando \texttt{Mathematica}, en donde se verá la relativa facilidad para implementar el código y obtener la solución de cada uno de los ejercicios.
% 
% 
% Nota importante}
% Es importante señalar que se debe de tener conocimiento en la sintaxis para utilizar \texttt{Mathematica}, no es la intención de revisar cada sentencia que se mostrará, pero consultando la documentación podrán interpretar qué es lo que está haciendo cada línea.
% 
% 
% Primer ejemplo resonancia}
% El primer ejemplo que resolvimos es el siguiente:
% \begin{align*}
% \stilde{x} + \omega_{0}^{2} \, x = F_{0} \, \sin \omega \, t, \hspace{1cm} x(0) = \ptilde{x} (0) = 0
% \end{align*}
% 
% 
% Estrategia de solución}
% Es importante que siempre tengamos planteada una estructura de la solución antes de escribir una instrucción en \texttt{Mathematica} como en otros programas o lenguajes.
% 
% 
% Pasos de solución}
% Ocuparemos los siguientes pasos:
% \setbeamercolor{item projected}{bg=blue!70!black,fg=yellow}
% \setbeamertemplate{enumerate items}[circle]
% \begin{enumerate}[<+->]
% \item \textbf{Paso 1: } La función \funcionazul{LaplaceTransform} requiere como argumento: la función a transformar, y los argumentos $t$, $s$.
% \item \textbf{Paso 2: } Aplicamos las condiciones iniciales del problema.
% \item \textbf{Paso 3: } Se resuelve la ecuación algebraica para $X(s)$, usando la función \funcionazul{Solve}.
% \seti
% \end{enumerate}
% 
% 
% Pasos de solución}
% Una vez conocida $X(s)$, aplicamos la transformada inversa de Laplace
% \setbeamercolor{item projected}{bg=blue!70!black,fg=yellow}
% \setbeamertemplate{enumerate items}[circle]
% \begin{enumerate}[<+->]
% \conti
% \item La variable \texttt{\textbf{sol}} tendrá el resultado que devuelve la función \funcionazul{InverseLaplaceTransform}, que ocupa como primer argumento la solución algebraica del \textbf{Paso 3}, punto importante: el valor se anota a mano; los otros argumentos son $s$, $t$.
% \seti
% \end{enumerate}
% 
% 
% Pasos de solución}
% \setbeamercolor{item projected}{bg=blue!70!black,fg=yellow}
% \setbeamertemplate{enumerate items}[circle]
% \begin{enumerate}[<+->]
% \setcounter{enumi}{4}
% \item En este mismo paso, se ocupa la función \funcionazul{Simplify} que usa como argumento, el inciso anterior, esta función reducirá lo más posible el resultado.
% \item La función \funcionazul{Expand}, extiende el resultado en términos de las potencias involucradas.
% \end{enumerate}
% 
% 
% Pasos de solución}
% \setbeamercolor{item projected}{bg=blue!70!black,fg=yellow}
% \setbeamertemplate{enumerate items}[circle]
% \begin{enumerate}[<+->]
% \setcounter{enumi}{6}
% \item Se grafica la solución mediante la función \funcionazul{Plot}, que ocupa de argumentos: la función a graficar, la variable independiente, así como el intervalo de graficación. 
% \end{enumerate}
% 
% [fragile]
% El código en \texttt{Mathematica}}
% Con $F_{0} = 1$ y $\omega = 1.25$
% 
% 
% \begin{lstlisting}[language=Mathematica]
% paso1 = LaplaceTransform[x''[t]+(1.25)^2 x[t] == Sin[1.25t],t,s] ||
% paso2 = paso1 /. {x[0] -> 0, x'[0] -> 0} ||
% paso3 = Solve[paso2, LaplaceTransform[x[t], t, s]]
% \end{lstlisting}
% 
% El \textbf{Paso 3} nos devuelve: $X(s) = 1.25/(1.5625 + s^{2})$, que se debe de ocupar para el uso de la transformada inversa de Laplace.
% 
% [fragile]
% El código en \texttt{Mathematica}}
% \begin{lstlisting}[language=Mathematica]
% sol = Simplify[InverseLaplaceTransform[1.25/(1.5625 + s^2)^2, s, t]] // Expand ||
% Plot[sol, {t, 0, 10 Pi}, PlotLabel -> "Grafica de la solucion x(t)", LabelStyle -> Directive[FontSize -> 12], PlotStyle -> {Red}]
% \end{lstlisting}
% 
% 
% Grafica obtenida}
% \begin{figure}[H]
%     \centering
%     \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_01_01.eps}
%     \caption{Solución obtenida con \texttt{Mathematica}.}
% \end{figure}
% 
% 
% Rectas envolventes}
% De la solución \enquote{a mano} sabemos que hay un par de rectas envolventes, conocemos la expresión de éstas, por lo que ahora podemos incluirlas en el código y así visualizarlas.
% 
% [fragile]
% El código en \texttt{Mathematica}}
% \begin{lstlisting}[language=Mathematica]
% recta1 = Sqrt[(1.25)^2 t ^2 + 1]/(2*(1.25)^2) ||
% Plot[{sol, recta1, -recta1 }, {t, 0, 10 Pi}, PlotStyle -> {{Red, Dashing[None]}, {Blue, Dashing[None]}, {Blue, Dashing[None]}}]
% \end{lstlisting}
% 
% 
% Grafica obtenida}
% \begin{figure}[H]
%     \centering
%     \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_01_02.eps}
%     \caption{Solución obtenida con \texttt{Mathematica} y las envolventes.}
% \end{figure}
% 
% 
% Agregando texto a la gráfica}
% Con \texttt{Mathematica} es posible agregar texto (entre otros elementos) y darle un mejor formato a la gráfica, no requiere el uso de comandos.
% 
% 
% 
% Aunque también se pueden agregar elementos desde el código, pero como primer paso, el uso de las herramientas de dibujo facilita el trabajo.
% 
% 
% Grafica obtenida con texto}
% \begin{figure}[H]
%     \centering
%     \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_01_03.eps}
%     \caption{Solución obtenida con \texttt{Mathematica}, las envolventes y texto agregado.}
% \end{figure}
% 
% \subsection{Segundo ejercicio de resonancia}
% 
% Segundo ejemplo de resonancia}
% Ahora resolveremos el segundo ejercicio de resonancia:
% \begin{align*}
% \stilde{x} + 0.4 \, \ptilde{x} + 9.04 \, x = 6 \, \exp\left( -\dfrac{t}{5}\right) \, \cos 3 \, t
% \end{align*}
% Con las condiciones iniciales:
% \begin{align*}
% x(0) = \ptilde{x}(0) = 0
% \end{align*}    
% 
% [fragile]
% Código en \texttt{Mathematica}}
% \begin{lstlisting}[language=Mathematica]
% EDO01 = x''[t]+0.4x'[t]+9.04x[t]== 6 Exp[-t/5]Cos[3 t] ||
% paso1 = LaplaceTransform[EDO01,t,s] ||
% paso2 = paso1/.{x[0]->0,x'[0]->0} ||
% paso3 = Solve[paso2,LaplaceTransform[x[t],t,s]]
% \end{lstlisting}
% 
% 
% Solución para $X(s)$}
% El \textbf{Paso 3} devuelve el valor:
% \begin{align*}
% X(s) = \dfrac{6 \, (s + 0.2)}{\left(s^2 + 0.4 \, s + 9.04\right) \left((s + 0.2)^2 + 9\right)}
% \end{align*}
% que se debe de ocupar para la transformada inversa de Laplace.
% 
% [fragile]
% Código en \texttt{Mathematica}}
% \begin{lstlisting}[language=Mathematica]
% sol = Simplify[InverseLaplaceTransform[(6 (0.2 +s))/((9.04 +0.4s+s^2)(9+(0.2+s)^2)),s,t]]//Expand ||
% Plot[sol,{t,0,10 Pi},PlotLabel->"Grafica de la funcion x(t)", LabelStyle->Directive[FontSize->12],PlotStyle->{Red}]
% \end{lstlisting}
% 
% 
% Gráfica de la solución $x(t)$}
% \begin{figure}[H]
%     \centering
%     \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_01.eps}
%     \caption{Solución obtenida con \texttt{Mathematica}.}
% \end{figure}
% 
% [fragile]
% Para encontrar el valor máximo}
% Para determinar el máximo de la función $x(t)$, ocupando \texttt{Mathematica} siguiendo el análisis que en la solución \enquote{a mano}: 
% \begin{lstlisting}[language=Mathematica]
% curva = t* Exp[-t/5] ||
% derivada = D[curva, t] ||
% derivada2 = D[curva, {t, 2}] ||
% derivada2 /. t -> 5 ||
% Solve[derivada == 0, t]
% \end{lstlisting}
% 
% [fragile]
% Otra manera de encontrar el valor máximo}
% La función \textbf{Maximize} calcula el valor máximo de una función en el intervalo que se proporciona, no es necesariamente el mismo procedimiento que se siguió con la lógica de Cálculo I. 
% \begin{lstlisting}[language=Mathematica]
% Maximize[{curva, (t >= 0) && (t <= 30)}, t]
% \end{lstlisting}
% Que nos devuelve el mismo valor.
% 
% 
% Graficando las envolventes}
% Para graficar las curvas envolventes, hacemos la misma técnica: tomamos el valor absoluto de $x(t)$, se ocupan los puntos de las crestas para ocupar una técnica de regresión lineal, de mínimos cuadrados que nos devuelva una ecuación de la curva envolvente.
% 
% [fragile]
% Otra manera de encontrar el valor máximo}
% \begin{lstlisting}[language=Mathematica]
% Plot[Abs[sol],{t,0,10 Pi},PlotLabel->"Grafica de la funcion |x(t)|", LabelStyle->Directive[FontSize->12],PlotStyle->{Red}]
% \end{lstlisting}
% La siguiente figura es la que se obtiene:
% 
% 
% Gráfica del valor absoluto de $x(t)$}
% \begin{figure}[H]
%     \centering
%     \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_02.eps}
%     \caption{Gráfica del valor absoluto de la solución $x(t)$.}
% \end{figure}
% 
% [fragile]
% Gráfica con una envolvente}
% \begin{lstlisting}[language=Mathematica]
% Plot[{sol, curva}, {t, 0, 10 Pi}, PlotLabel -> "Grafica de la funcion x(t) y una envolvente", 
% LabelStyle -> Directive[FontSize -> 12], PlotStyle -> {Red, Blue}]
% \end{lstlisting}
% La siguiente figura es la que se obtiene:
% 
% 
% Gráfica de $x(t)$ y una envolvente}
% \begin{figure}[H]
%     \centering
%     \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_03.eps}
%     \caption{Solución obtenida con \texttt{Mathematica} y una curva envolvente.}
% \end{figure}
% 
% [fragile]
% Gráfica con las dos envolventes}
% \begin{lstlisting}[language=Mathematica]
% Plot[{sol,curva, -curva},{t,0,10 Pi},PlotStyle->{{Red,Dashing[None]},{Blue,Dashing[None]}, {Blue,Dashing[None]}}]
% \end{lstlisting}
% La dos curvas envolventes se muestran en la siguiente figura:
% 
% 
% Gráfica de $x(t)$ y las curvas envolventes}
% \begin{figure}[H]
%     \centering
%     \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_04.eps}
%     \caption{Solución obtenida con \texttt{Mathematica} y las curvas envolventes.}
% \end{figure}
% 
% 
% Gráfica con otros elementos}
% Usando las herramientas de dibujo se puede agregar otros elementos como texto normal o texto con formato matemático, como en la siguiente figura.
% 
% 
% 
% Agregar estos elementos favorecen una mejor lectura para la gráfica que se esté generando.
% 
% 
% Gráfica de $x(t)$ y las curvas envolventes}
% \begin{figure}[H]
%     \centering
%     \includegraphics[scale=1]{Imagenes/Ejemplo_Resonancia_05.eps}
%     \caption{Solución obtenida con \texttt{Mathematica}, las curvas envolventes y texto agregado en la gráfico.}
% \end{figure}
% 
% \subsection{Masas acopladas}
% 
% Resolviendo el ejercicio}
% Ahora trabajaremos el mismo ejercicio del sistema de masas acopladas con dos resortes, se mostrará el código utilizado en \texttt{Mathematica}.
% 
% [fragile]
% Código en \texttt{Mathematica}}
% \begin{lstlisting}[language=Mathematica]
% Clear[x, y, t] ||
% sys = {x''[t] == -10 x[t] + 4 y[t], y''[t] == -4 y[t] + 4 x[t]} ||
% paso1 = LaplaceTransform[sys, t, s] ||
% paso2 = paso1 /. {x[0] -> 0, x'[0] -> 1, y[0] -> 0, y'[0] -> -1} ||
% paso3 = Solve[paso2, {LaplaceTransform[x[t], t, s], LaplaceTransform[y[t], t, s]}] // Simplify
% \end{lstlisting}    
% 
% [fragile]
% Código en \texttt{Mathematica}}
% \begin{lstlisting}[language=Mathematica]
% x[t_]=InverseLaplaceTransform[paso3[[1,1,2]],s,t] ||
% y[t_] = InverseLaplaceTransform[paso3[[1, 2, 2]], s, t] ||
% Plot[{x[t],y[t]},{t,0,4Pi}, PlotLegends->{"Subscript[x, 1](t)", "Subscript[x, 2](t)"}, PlotLabel->"Grafica del movimiento de las masas acopladas", LabelStyle->Directive[FontSize->12]]
% \end{lstlisting}    
% 
% 
% Gráfica de $x_{1}(t)$ y $x_{2}(t)$}
% \begin{figure}[H]
%     \centering
%     \includegraphics[scale=0.95]{Imagenes/Ejercicio_masas_acopladas_01.eps}
%     \caption{Gráfica obtenida usando las funciones de la transformada de Laplace y la transformada inversa para el sistema de dos masas acopladas mediante resortes.}
% \end{figure}
% 
   
% Extendiendo la interpretación: ahora contamos con más elementos que aportarán a la interpretación del resultado: si graficamos $x_{1}$ vs $x_{2}$ obtendremos el \texttt{espacio fase} del sistema.

% [fragile]
% Código en \texttt{Mathematica}}
% \begin{lstlisting}[language=Mathematica]
% ParametricPlot[{x[t], y[t]}, {t, 0, 4 Pi}, AspectRatio -> 1, PlotLabel -> "Espacio fase de las masas acopladas", LabelStyle -> Directive[FontSize -> 12]]
% \end{lstlisting}    
% 

% \begin{figure}[H]
%     \centering
%     \includegraphics[scale=0.7]{Imagenes/Ejercicio_masas_acopladas_03.eps}
% \end{figure}


\end{document}