\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{calc}
\usepackage{scalerel}
\usepackage{geometry}
\usepackage{bm}
\usepackage{physics}
\usepackage{graphicx}
\geometry{margin=1in}

\newcommand{\pderivada}[1]{\ensuremath{{#1}^{\prime}}}
\newcommand{\sderivada}[1]{\ensuremath{{#1}^{\prime \prime}}}
\newcommand{\tderivada}[1]{\ensuremath{{#1}^{\prime \prime \prime}}}
\newcommand{\nderivada}[2]{\ensuremath{{#1}^{(#2)}}}

\def\stretchint#1{\vcenter{\hbox{\stretchto[440]{\displaystyle\int}{#1}}}}
\def\scaleint#1{\vcenter{\hbox{\scaleto[3ex]{\displaystyle\int}{#1}}}}
\def\scaleiint#1{\vcenter{\hbox{\scaleto[6ex]{\displaystyle\iint}{#1}}}}
\def\scaleiiint#1{\vcenter{\hbox{\scaleto[6ex]{\displaystyle\iiint}{#1}}}}
\def\scaleoint#1{\vcenter{\hbox{\scaleto[3ex]{\displaystyle\oint}{#1}}}}
\def\bs{\mkern-12mu}

\newlength{\depthofsumsign}
\setlength{\depthofsumsign}{\depthof{$\sum$}}
\newcommand{\nsum}[1][1.4]{% only for \displaystyle
    \mathop{%
        \raisebox
            {-#1\depthofsumsign+1\depthofsumsign}
            {\scalebox
                {#1}
                {$\displaystyle\sum$}%
            }
    }
}

\linespread{1.25}

\title{Ejercicios con funciones de Bessel}
\author{M. en C. Gustavo Contreras Mayén}
\date{}

\begin{document}
\maketitle
\fontsize{14}{14}\selectfont

\section*{Ejercicio 1.}

Un cilindro macizo está limitado por las superficies r = 1, z = 0 y z = b. La primera superficie está aislada, la segunda se conserva a la temperatura cero, y la última a la temperatura f(r).

\section*{1. Ecuación y condiciones de contorno.}
Se busca la distribución de temperaturas estacionaria $u (r, z)$, asumiendo simetría axial (independencia de $\theta$) y regularidad en el eje $r = 0$.
\par
La ecuación de Laplace en coordenadas cilíndricas, para soluciones independientes de $\theta$, es:
\begin{equation}\label{laplace}
u_{rr} + \dfrac{1}{r} \, u_{r} + u_{zz} = 0, \qquad 0 \le r \le 1, \quad 0 \le z\le b.
\end{equation}
Donde las CDF son:
\begin{align}
u_{r} (1, z) &= 0, &0 \le z \le b \qquad &\text{(pared lateral aislada)},\label{bc_r} \\[1em]
u (r, 0) &= 0, &0 \le r \le 1 \qquad &\text{(base a temperatura cero)}, \label{bc_z0} \\[1em]
u (r, b) &= f (r), &0 \le r\le 1 \qquad &\text{(tapa con temperatura prescrita)}\label{bc_zb}
\end{align}
Además pedimos que $u$ sea finita en $r = 0$.

\section*{2. Separación de variables.}

Proponemos una solución de la forma:
\begin{align*}
    u (r, z) = R (r) \, Z (z)
\end{align*}
Donde $R (r)$ y $Z (z)$ dependen solo de su correspondiente variable. Sustituyendo en (\ref{laplace}) y dividiendo por $R \, Z$ obtenemos:
\begin{align*}
    \dfrac{\sderivada{R} (r) + \dfrac{1}{r} \, \pderivada{R} (r)}{R (r)} + \dfrac{\sderivada{Z} (z)}{Z (z)} = 0
\end{align*}
Dado que $r$ y $z$ son independientes entre sí, y para que esta igualdad tenga sentido, entonces cada término debe ser una constante; tomamos la constante de separación:
\begin{align*}
\dfrac{\sderivada{R}+ \dfrac{1}{r} \pderivada{R}}{R} = -\lambda^{2}, \qquad \dfrac{\sderivada{Z}}{Z} = \lambda^{2}
\end{align*}
Con esto queda un sistema de dos EDO:
\begin{align}
&\sderivada{R} + \dfrac{1}{r} \, \pderivada{R} + \lambda^{2} \, R = 0, \label{bessel} \\[1em]
&\sderivada{Z} - \lambda^{2} \, Z = 0 \label{zode}
\end{align}
Reconocemos que la ecuación radial (\ref{bessel}) es la ecuación de Bessel de orden cero.

\section*{3. Soluciones radiales y condiciones en $r = 0$ y $r = 1$.}

La solución general de (\ref{bessel}) es:
\begin{align*}
    R (r) = A \, J_{0} (\lambda \, r) + B \, Y_{0} (\lambda \, r)
\end{align*}
donde $J_{\nu}$ y $Y_{\nu}$ son las funciones de Bessel de primer y segundo tipo. La regularidad en el eje $r = 0$ exige que $B = 0$, ya que $Y_{0}$ diverge en $r = 0$. Entonces:
\begin{align*}\label{R}
R (r) = A \, J_{0} (\lambda \, r)
\end{align*}
La CDF en la pared aislada (Neumann) (\ref{bc_r}) implica que:
\begin{align*}
    u_{r} (1, z) = \pderivada{R} (1) \, Z (z) = 0 \quad \text{para todo } z
\end{align*}
Para las soluciones no triviales $Z \not \neq 0$ y $A \neq 0$, se requiere que:
\begin{align*}
    \pderivada{R} (1) = 0
\end{align*}
Necesitaremos una identidad que involucra a la derivada de la función de Bessel:
\begin{align*}
    \dv{x} \left[ x^{-\nu} \, J_{\nu} (x) \right] = -x^{-\nu} \, J_{\nu+1} (x)
\end{align*}
\textbf{Nota. en clase vimos la identidad:}
\begin{align*}
    \dv{x} \left[ x^{\nu} \, J_{\nu} (x) \right] = x^{\nu} \, J_{\nu-1} (x)
\end{align*}
que se obtiene al diferenciar directamente la expresión de la función de Bessel en términos de la suma infinita.
\par
Calculando $\pderivada{R} (r) = A \, \lambda (-J_{1} (\lambda \, r))$, en $r = 1$ se obtiene:
\begin{align*}
    -A \, \lambda \, J_{1} (\lambda) = 0
\end{align*}
Para soluciones no triviales con $A \neq 0$ y $\lambda \neq 0$ se necesita que:
\begin{equation}\label{alpha}
J_{1} (\lambda) = 0.
\end{equation}
Denotamos por $\alpha_{n}$ las raíces positivas de $J_{1}$, es decir:
\begin{align*}
    J_{1} (\alpha_{n}) = 0, \qquad 0 < \alpha_{1} < \alpha_{2} < \ldots
\end{align*}
Adicionalmente existe el caso especial $\lambda = 0$ que requiere tratamiento aparte (modo constante en $r$).

\section*{4. Soluciones en $z$.}

Para cada $\lambda = \alpha_{n} > 0$, la ecuación en $z$ (\ref{zode}) tiene por solución:
\begin{align*}
    Z (z) = C \, e^{\lambda z} + D \, e^{-\lambda z} = C \, \sinh(\lambda z) + D \, \cosh(\lambda z)
\end{align*}
La condición (\ref{bc_z0}) en $z = 0$ exige que $Z (0) = 0$, por tanto $D = 0$ y
\begin{align*}
    Z_{n} (z) = C_{n} \, \sinh(\alpha_{n} z)
\end{align*}
Para el modo $\lambda = 0$ la ecuación en $z$ es $\sderivada{Z} = 0$, cuyas soluciones son afines: $Z (z) = a + b \, z$. Imponiendo la condición $Z (0) = 0$ resulta $a = 0$ y entonces queda $Z_{0} (z) = b \, z$. Por tanto el modo de orden cero es proporcional a $z$ (constante en $r$).

\section*{5. Serie generalizada (superposición)}

Combinando todos los modos obtenemos la expansión general que satisface la ecuación de Laplace y las condiciones en $r = 0$ y $z = 0$:
\begin{equation}\label{u_series}
u (r, z) = A_{0} \, z + \nsum_{n=1}^{\infty} A_{n} \, J_{0} (\alpha_{n} r) \, \dfrac{\sinh (\alpha_n z)}{\sinh (\alpha_n b)}.
\end{equation}
Hemos elegido escribir la dependencia en $z$ normalizada por $\sinh(\alpha_n b)$ para facilitar la aplicación de la condición en $z = b$.

\section*{6. Uso de la condición en $z = b$ y cálculo de los coeficientes.}

Imponiendo (\ref{bc_zb}) en (\ref{u_series}) se tiene que:
\begin{equation}\label{expansion_fb}
f (r) = u (r, b) = A_{0} \, b + \nsum_{n=1}^{\infty} A_{n} \, J_{0} (\alpha_n r) \qquad 0 \le r \le 1
\end{equation}
Es decir, debemos expandir $f (r)$ en la base ortogonal formada por la constante y las funciones $J_{0} (\alpha_n r)$ en el intervalo $[0, 1]$ con la función de peso $r$.

\subsection*{Ortogonalidad y normas.}

Para las raíces $\alpha_{n}$ de (\ref{alpha}) se cumple la ortogonalidad (peso $r$):
\begin{equation}\label{ortho}
\scaleint{6ex}_{\bs 0}^{1} r \, J_{0} (\alpha_n r) \, J_{0} (\alpha_m r) \dd{r} = 0 \quad n\neq m
\end{equation}
La norma de cada modo es (fórmula estandar):
\begin{equation}\label{norma}
\scaleint{6ex}_{\bs 0}^{1} r \, [J_{0}(\alpha_n r)]^{2} \dd{r} = \dfrac{1}{2} \, [J_{0} (\alpha_n)]^{2}
\end{equation}
Además la función constante es ortogonal a todos los $J_{0} (\alpha_n r)$ con la función de peso $r$, ya que:
\begin{align*}
    \scaleint{6ex}_{\bs 0}^{1} r \, J_{0} (\alpha_n r) \dd{r} = \dfrac{J_{1}(\alpha_{n})}{\alpha_{n}} = 0
\end{align*}

\subsection*{Coeficientes.}

<<<<<<< Updated upstream
Calculamos los coeficientes usando la función de peso $r$:
=======
Definimos la proyección con la función de peso $r$:
>>>>>>> Stashed changes
\begin{align}
C_{0} &= \dfrac{\scaleint{6ex}_{\bs 0}^{1} r \, f (r) \dd{r}}{\scaleint{6ex}_{\bs 0}^{1} r \dd{r}} = 2 \, \scaleint{6ex}_{\bs 0}^{1} r \, f (r) \dd{r}, \label{C0} \\[1em]
C_{n} &= \dfrac{\displaystyle \scaleint{6ex}_{\bs 0}^{1} r \, f (r) \, J_{0} (\alpha_n r) \dd{r}}{\displaystyle \scaleint{6ex}_{\bs 0}^{1} r \, [J_{0} (\alpha_n r)]^{2} \dd{r}} = \dfrac{2}{[J_{0} (\alpha_n)]^{2}} \, \scaleint{6ex}_{\bs 0}^{1} r \, f (r) \, J_{0} (\alpha_n r) \dd{r} \quad n \ge 1 \label{Cn}
\end{align}
Comparando con (\ref{expansion_fb}) vemos que:
\begin{align}
&A_{0} \, b = C_{0} \quad \Rightarrow \quad A_{0} = \dfrac{C_{0}}{b} = \dfrac{2}{b} \scaleint{6ex}_{\bs 0}^{1} r \, f (r) \dd{r} \label{A0} \\[1em]
&A_{n} = C_{n} = \dfrac{2}{[J_{0} (\alpha_n)]^{2}} \, \scaleint{6ex}_{\bs 0}^{1} r \, f (r) \, J_{0} (\alpha_{n} r) \dd{r} \qquad n \ge 1 \label{An}
\end{align}

\section*{7. Solución final.}

Sustituyendo (\ref{A0}) y (\ref{An}) en (\ref{u_series}) obtenemos la solución en series:
\begin{align}
\begin{aligned}
<<<<<<< Updated upstream
u (r, z) &= \dfrac{2 \, z}{b} \, \scaleint{6ex}_{\bs 0}^{1} r \, f (r) \dd{r} + \nsum_{n=1}^{\infty} \left( \dfrac{2}{[J_{0}(\alpha_{n})]^{2}} \, \scaleint{6ex}_{\bs 0}^{1} r \, f (r) \, J_{0}(\alpha_{n} r) \dd{r} \right) \times \\[1em]
&\times J_{0} (\alpha_{n} r) \, \dfrac{\sinh (\alpha_{n} z)}{\sinh (\alpha_{n} b)},
=======
u (r, z) &= \dfrac{2 \, z}{b} \, \scaleint{6ex}_{\bs 0}^{1} r \, f (r) \dd{r} + \nsum_{n=1}^{\infty} \left( \dfrac{}{[J_{0}(\alpha_{n})]^{2}} \, \scaleint{6ex}_{\bs 0}^{1} r \, f (r) \, J_{0}(\alpha_{n} r) \dd{r} \right) \times \\[1em]
&\times J_{0} (\alpha_{n} r) \, \dfrac{\sinh (\alpha_{n} z)}{\sinh (\alpha_{n} b)}
>>>>>>> Stashed changes
\end{aligned}
\label{sol_final}
\end{align}
donde $\alpha_{n}$ es la $n$-ésima raíz positiva de $J_{1} (\alpha) = 0$.

% \section*{8. Comentarios}
% \begin{itemize}
% \item El primer término corresponde al modo $\lambda=0$ (dependencia lineal en $z$ y constante en $r$).
% \item Los restantes términos son modos radiales proporcionales a $J_0(\alpha_n r)$ que satisfacen la condición Neumann en $r=1$.
% \item Las integrales para $A_n$ se calculan seg'un la función $f(r)$. Para funciones simples pueden obtenerse expresiones analíticas; en general se eval'uan numéricamente y se truncará la serie para aproximaciones.
% \item Si se desea, se puede reescribir la serie usando funciones hiperbólicas alternas (por ejemplo, combinando exponenciales) o usando la forma sin normalizar en $z$ y resolviendo para las constantes $C_n$ directamente.
% \end{itemize}

% \bigskip
% \noindent{\small Nota: para evaluar numéricamente los coeficientes se requieren los valores numéricos de las raíces $\alpha_n$ de $J_1$ (las primeras raíces son aproximadamente $\alpha_1\approx3.8317$, $\alpha_2\approx7.0156$, ...).}

<<<<<<< Updated upstream
\newpage

\section*{Ejercicio 2.}

Cuando $f (r) = A, \quad (0 < r < 1)$ en el problema anterior, demuestra que:
=======
\section*{Ejercicio 2.}

Cuando $f (r) = A, \quad (0 < r < 1)$ en el problema anterior, demuestra que:

>>>>>>> Stashed changes
\begin{align*}
    u (r, z) = \dfrac{A \, z}{b}
\end{align*}
% Partiendo del problema anterior (cilindro macizo con $0 \le r \le 1$, $0 \le z \le b$, con la pared lateral aislada $u_{r} (1, z) = 0$, y con la base $u (r, 0) = 0$ y la tapa $u (r, b) = f (r)$), demuestre que si
% [ f(r)=A,\qquad 0<r<1,]
% la solución estacionaria es
% [ u(r,z)=\frac{A z}{b}.]

\section*{Solución.}

Usamos la forma general de la solución obtenida por separación de variables:
\begin{equation}\label{u_general}
u (r, z) = A_{0} \, z + \nsum_{n=1}^{\infty} A_{n} \, J_{0} (\alpha_{n} r) \, \dfrac{\sinh(\alpha_{n} z)}{\sinh(\alpha_{n} b)},
\end{equation}
donde ${\alpha_{n}}$ son las raíces positivas de $J_{1}(\alpha) = 0$ y los coeficientes vienen dados por:
\begin{align}
A_{0} &= \dfrac{2}{b} \, \scaleint{6ex}_{\bs 0}^{1} r \, f (r) \dd{r}, \label{A0_def} \\[1em]
A_{n} &= \dfrac{2}{[J_{0}(\alpha_{n})]^{2}} \scaleint{6ex}_{\bs 0}^{1} r \, f (r) \, J_{0}(\alpha_{n} r) \dd{r} \label{An_def}
\end{align}
Sustituimos $f (r) = A$ (constante) en las fórmulas de los coeficientes.

\subsection*{Cálculo de $A_0$.}

\begin{align*}
A_{0} &= \dfrac{2}{b} \, \scaleint{6ex}_{0}^{1} r \, A \, \dd{r} = \dfrac{2 \, A}{b} \left[ \dfrac{r^{2}}{2} \right]_{0}^{1} = \dfrac{2 \, A}{b} \cdot \dfrac{1}{2} = \dfrac{A}{b}
\end{align*}
Por tanto el término del modo $\lambda = 0$ es:
\begin{align*}
    A_{0} \, z = \dfrac{A}{b} \, z = \dfrac{A \, z}{b}
\end{align*}

\subsection*{Cálculo de $A_{n}$ para $n \ge 1$.}

Para $n \ge 1$:
\begin{align*}
A_{n} &= \dfrac{2}{[J_{0} (\alpha_{n})]^{2}} \scaleint{6ex}_{\bs 0}^{1} r \, A \, J_{0} (\alpha_{n} r) \dd{r} = \dfrac{2 \, A}{[J_{0}(\alpha_{n})]^{2}} \scaleint{6ex}_{\bs 0}^{1} r \, J_{0} (\alpha_{n} r) \dd{r}
\end{align*}
Usamos la identidad integral conocida (ver el Anexo):
\begin{align*}
    \scaleint{6ex}_{\bs 0}^{1} r \, J_{0} (\alpha_{n} r) \dd{r} = \dfrac{J_{1} (\alpha_{n})}{\alpha_{n}}
\end{align*}
Como $\alpha_{n}$ son ceros de $J_{1}$, tenemos que $J_{1} (\alpha_{n}) = 0$; por tanto la integral vale cero y entonces:
\begin{align*}
    A_{n} = 0 \qquad n \ge 1
\end{align*}

% \subsection*{Conclusión}
Sustituyendo en (\ref{u_general}) se anulan todos los términos de la suma y queda solo el modo constante en $r$:
\begin{align*}
    u (r, z) = \dfrac{A \, z}{b}
\end{align*}
Observamos que esta solución es independiente de $r$, satisface la ecuación de Laplace, ya que:
\begin{align*}
    u_{rr} + \dfrac{1}{r} \, u_{r} = 0 \hspace{1cm} \text{y} \hspace{1cm} u_{zz} = 0
\end{align*}
la condición en $z = 0$ (da cero) y en $z = b$ da $u (r, b) = A$; además satisface $u_{r} (1, z) = 0$, porque no depende de $r$.

% \section*{Comentario final}
El resultado intuitivo es que si la tapa superior tiene temperatura constante y la pared lateral es aislada, la distribución estacionaria en el cilindro es una función lineal de $z$ que va de $0$ en la base a $A$ en la tapa; la independencia respecto a $r$ proviene de la simetría y de que la condición Neumann en la pared lateral no introduce variación radial cuando la frontera superior es constante.

\section*{Anexo.}

Consideremos la siguiente integral: %que aparece frecuentemente en problemas de conducción de calor o vibraciones con simetría cilíndrica:
\begin{align*}
    I = \scaleint{6ex}_{\bs 0}^{1} r \, J_{0} (\alpha_{n} r) \dd{r}
\end{align*}
donde $J_{0}$ es la función de Bessel de primer tipo y de orden cero, y $\alpha_{n}$ es una constante positiva (por lo general, una raíz de alguna CDF).

Hacemos el cambio de variable $x = \alpha_{n} \, r$, de modo que:
\begin{align*}
     r = \dfrac{x}{\alpha_{n}}, \hspace{1.5cm} \dd{r} = \dfrac{\dd{x}}{\alpha_{n}}
\end{align*}
Entonces se tiene que:
\begin{align*}
I = \scaleint{6ex}_{\bs 0}^{\alpha_{n}} \dfrac{x}{\alpha_{n}} \, J_{0} (x) \dfrac{\dd{x}}{\alpha_{n}} = \dfrac{1}{\alpha_{n}^{2}} \scaleint{6ex}_{0}^{\alpha_{n}} x \, J_{0} (x) \dd{x}
\end{align*}
Por lo tanto:
\begin{align*}
I = \dfrac{1}{\alpha_{n}^{2}} \scaleint{6ex}_{0}^{\alpha_{n}} x \, J_{0} (x) \dd{x}
\end{align*}

Recordemos la relación de recurrencia entre $J_{0}$ y $J_{1}$:
\begin{align*}
    \dv{x} \bigl[ x \, J_{1} (x) \bigr] = x \, J_{0} (x)
\end{align*}
% \textit{Demostración rápida:}
% \begin{align*}
% \frac{d}{dx}\bigl[x J_1(x)\bigr] &= J_1(x) + x J_1'(x) \
% &= J_1(x) + x\left(J_0(x) - \frac{J_1(x)}{x}\right) = x J_0(x).
% \end{align*}
Usando esta relación, podemos escribir la integral como:
\begin{align*}
\scaleint{6ex}_{0}^{\alpha_{n}} x \, J_{0} (x) \dd{x} = \scaleint{6ex}_{\bs 0}^{\alpha_{n}} \dv{x} \bigl[ x \, J_{1} (x) \bigr] \dd{x}
\end{align*}
Por el teorema fundamental del cálculo:
\begin{align*}
\scaleint{6ex}_{\bs 0}^{\alpha_{n}} x \, J_{0} (x) \dd{x} = \left[ x \, J_{1} (x) \right]_{0}^{\alpha_{n}} = \alpha_{n} \, J_{1}(\alpha_{n}) - 0
\end{align*}
Sustituyendo este resultado en la integral original:
\begin{align*}
I = \dfrac{1}{\alpha_{n}^{2}} (\alpha_{n} \, J_{1}(\alpha_{n})) = \dfrac{J_{1} (\alpha_{n})}{\alpha_{n}}
\end{align*}
Se obtiene la identidad integral:
\begin{align*}
\boxed{\displaystyle \scaleint{6ex}_{0}^{1} r \, J_{0} (\alpha_{n} r) \dd{r} = \dfrac{J_{1} (\alpha_{n})}{\alpha_{n}}}
\end{align*}

% \section*{6. Comentarios}
% \begin{itemize}
% \item Esta relación se utiliza para proyectar condiciones de frontera radiales $f(r)$ sobre las funciones base $J_0(\alpha_n r)$.
% \item Si $\alpha_n$ es una raíz de $J_0$, es decir, $J_0(\alpha_n) = 0$, esta identidad es particularmente útil para calcular coeficientes de expansión en series de Bessel.
% \item La deducción sólo usa la identidad de derivada de Bessel y un cambio de variable sencillo.
% \end{itemize}

\end{document}
