\input{../Preambulos/preambulo_materiales}
\title{Método de expansión en eigenfunciones \\ \large {Bases completas}\vspace{-3ex}}

\author{M. en C. Gustavo Contreras Mayén}
\date{ }

\pagestyle{fancy}
\fancyhf{}
\rhead{Curso MAF}
\lhead{\leftmark}
\rfoot{\thepage}
\setlength{\headheight}{16pt}%

\begin{document}
\maketitle
\fontsize{14}{14}\selectfont
\tableofcontents
\newpage

%ref. Herman (2015) 4.3 The eigenfunction expansion method
\section{Expansión en eigenfunciones.}

En este material resolveremos el problema no homogéneo $\mathcal{L} \, y = f$ usando expansiones sobre la base de las eigenfunciones de Sturm-Liouville. Hemos visto que los problemas de eigenvalores de Sturm-Liouville tienen el conjunto necesario de eigenfunciones ortogonales. En esta parte, aplicaremos el método de desarrollo de eigenfunciones para resolver un problema de valores en la frontera no homogéneo en particular.

\section{El problema no homogéneo.}

Recordemos que iniciamos con una ecuación diferencial no homogénea:
\begin{align*}
\mathcal{L} \, y = f
\end{align*}
donde $y (x)$ debe satisfacer las condiciones de frontera homogéneas dadas. El método de expansión hace uso de las eigenfunciones que satisfacen el problema de eigenvalor:
\begin{align*}
\mathcal{L} \, \phi_{n} = - \lambda_{n} \, \sigma \, \phi_{n}
\end{align*}
sujeta a las condiciones de frontera dadas. Entonces, suponemos que $y (x)$ se puede escribir como una expansión de las eigenfunciones:
\begin{align*}
y (x) = \nsum_{n=1}^{\infty} c_{n} \, \phi_{n} (x)
\end{align*}
y sustituimos la expansión en la ecuación no homogénea. Esto nos da:
\begin{align*}
f (x) = \mathcal{L} \bigg( \nsum_{n=1}^{\infty} c_{n} \, \phi_{n} (x) \bigg) = - \nsum_{n=1}^{\infty} c_{n} \, \lambda_{n} \, \phi_{n} (x)
\end{align*}
Luego, los coeficientes de expansión $c_{n}$ se calculan haciendo uso de la ortogonalidad de las eigenfunciones. Es decir, multiplicamos la última ecuación por $\phi_{m} (x)$ y posteriormente integramos, obteniendo:
\begin{align*}
\scaleint{6ex}_{\bs a}^{b} f (x) \, \phi_{m} (x) \dd{x} = - \nsum_{n=1}^{\infty} c_{n} \, \lambda_{n} \, \scaleint{6ex}_{\bs a}^{b} \phi_{n} (x) \, \phi_{m} (x) \sigma (x) \dd{x}
\end{align*}
La ortogonalidad nos lleva a:
\begin{align*}
\scaleint{6ex}_{\bs a}^{b} f (x) \, \phi_{m} (x) \dd{x} = - c_{m} \, \lambda_{m} \, \scaleint{6ex}_{\bs a}^{b} \big[ \phi_{m} (x) \big]^{2} \, \sigma (x) \dd{x}
\end{align*}
Resolviendo para $c_{m}$:
\begin{align*}
c_{m} = - \dfrac{\scaleint{6ex}_{\bs a}^{b} f (x) \, \phi_{m} (x) \dd{x}}{\lambda_{m} \, \scaleint{6ex}_{\bs a}^{b} \big[ \phi_{m} (x) \big]^{2} \, \sigma (x) \dd{x}}
\end{align*}

\subsection{Ejemplo del método.}

\begin{ejemplo}
Consideremos la solución del problema del valor en la frontera:
\begin{align}
(x \, \pderivada{y})^{\prime} + \dfrac{y}{x} = \dfrac{1}{x} \hspace{1.3cm} x \in [1, e] \label{eq:ecuacion_04_24} \\
y (1) = 0 = y (e) \label{eq:ecuacion_04_25}
\end{align}
Esta ecuación ya está en forma autoadjunta. Entonces, sabemos que el problema de Sturm-Liouville de eigenvalores asociado tiene un conjunto ortogonal de eigenfunciones. Primero determinamos éste conjunto. Es decir, tenemos que resolver:
\begin{align}
(x \, \pderivada{\phi})^{\prime} + \dfrac{\phi}{x} = -\lambda \, \sigma \, \phi, \hspace{1.3cm} \phi (1) = 0 =\phi (e)
\label{eq:ecuacion_04_26}
\end{align}

Organizando los términos y multiplicando por $x$, tenemos lo siguiente:
\begin{align*}
x^{2} \, \sderivada{\phi} + x \, \pderivada{\phi} + (1 + \lambda \, \sigma \, x) \, \phi = 0
\end{align*}
Esta es casi una ecuación del tipo de Cauchy-Euler. Eligiendo la función de peso $\sigma (x) = 1 / x$, llegamos a:
\begin{align*}
x^{2} \, \sderivada{\phi} + x \, \pderivada{\phi} + (1 + \lambda ) \, \phi = 0
\end{align*}
Que fácilmente se puede resolver. La ecuación característica es:
\begin{align*}
r^{2} + (1 + \lambda) = 0
\end{align*}
Se obtienen soluciones no triviales del problema de eigenvalores que satisfacen las condiciones de frontera cuando $\lambda > -1$. Las soluciones son:
\begin{align*}
\phi_{n} (x) = A \, \sin (n \, \pi \, \ln x), \hspace{1.3cm} n = 1, 2, \ldots
\end{align*}
donde $\lambda_{n} = n^{2} \, \pi^{2} - 1$.

A menudo es útil normalizar las eigenfunciones. Esto significa que uno elige el valor de $A$ para que la norma de cada eigenfunción sea uno. Así, tenemos:
\begin{align}
\begin{aligned}[b]
1 &= \scaleint{6ex}_{\bs 1}^{e} \big[ \phi_{n} (x) \big]^{2} \, \sigma (x) \dd{x} = \\[0.5em]
&= A^{2} \, \scaleint{6ex}_{\bs 1}^{e} \sin (n \, \pi \, \ln x) \, \dfrac{1}{x} \dd{x} = \\[0.5em]
&= A^{2} \, \scaleint{6ex}_{\bs 0}^{1} \sin (n \, \pi \, y) \dd{y} = \\[0.5em]
&= \dfrac{1}{2} \, A^{2}
\end{aligned}
\label{eq:ecuacion_04_27}
\end{align}
Por lo que: $A = \sqrt{2}$. Se muestran varias de las eigenfunciones en la figura (\ref{fig:figura_04_02}).
\begin{figure}[H]
    \centering
    \includegraphics[scale=1]{Imagenes/Expansion_Eigenfunciones_01.eps}
    \caption{Gráfica de las eigenfunciones del ejemplo.}
    \label{fig:figura_04_02}
\end{figure}
Ahora nos enfocamos en resolver el problema no homogéneo $\mathcal{L} \, y = 1 / x$. Primero desarrollamos la solución desconocida en términos de las eigenfunciones:
\begin{align*}
y (x) = \nsum_{n=1}^{\infty} c_{n} \, \sqrt{2} \sin (n \, \pi \, \ln x)
\end{align*}
Sustituyendo esta solución en la ecuación diferencial, se tiene lo siguiente:
\begin{align*}
\dfrac{1}{x} = \mathcal{L} \, y = - \nsum_{n=1}^{\infty} c_{n} \, \lambda_{n} \, \sqrt{2} \, \sin (n \, \pi \, \ln x) \, \dfrac{1}{x}
\end{align*}
Nuevamente usamos la ortogonalidad de las eigenfunciones. Multiplicamos ambos lados de la expresión por la eigenfunción:
\begin{align*}
\phi_{m} (x) = \sqrt{2} \, \sin (m \, \pi \, \ln x)
\end{align*}
para luego integrar, entonces tendremos que:
\begin{align*}
\lambda_{m} \, c_{m} = \scaleint{6ex}_{\bs 1}^{e} \sqrt{2} \, \sin (m \, \pi \, \ln x) \, \dfrac{1}{x} \dd{x} = \dfrac{\sqrt{2}}{m \, \pi} \, \big[ (-1)^{m} - 1 \big]
\end{align*}
Resolviendo para los $c_{m}$:
\begin{align*}
c_{m} = \dfrac{\sqrt{2}}{m \, \pi} \, \dfrac{\big[ (-1)^{m} - 1 \big]}{m^{2} \, \pi^{2} - 1}
\end{align*}
Finalmente, sustituimos estos coeficientes en la expansión de $y (x)$. La solución es entonces:
\begin{align*}
y (x) = \nsum_{n=1}^{\infty} \dfrac{2}{n \, \pi} \dfrac{\big[ (-1)^{n} - 1 \big]}{n^{2} \, \pi^{2} - 1} \sin (n \, \pi \, \ln x)
\end{align*}
La solución se muestra en la figura (\ref{fig:figura_04_03}).
\begin{figure}[H]
    \centering
    \includegraphics[scale=1]{Imagenes/Expansion_Eigenfunciones_02.eps}
    \caption{Gráfica de la solución del ejemplo, se utilizó $n = 40$.}
    \label{fig:figura_04_03}
\end{figure}
\end{ejemplo}

% \section{Una base completa y ortogonal.}
% \subsection{Resolviendo el ejercicio 2.}

% %Ref. Zettili Problem 2.2

% \begin{enumerate}[label=\alph*)]
% \item Encuentra una base completa y ortonormal para el espacio de las funciones trigonométricas de la forma:
% \begin{align*}
% \psi(\theta) = \nsum_{n=0}^{N} a_{n} \, \cos (n \, \theta)
% \end{align*}
% \item Calcula los vectores base con $N = 5$.
% \end{enumerate}

% Para resolver el primer inciso, ocupemos una identidad conocida para expresar $\psi(\theta)$:
% \begin{align*}
% \psi(\theta) &= \nsum_{n=0}^{N} a_{n} \, \cos (n \, \theta) = \\[0.5em] 
% &= \dfrac{1}{2} \nsum_{n=0}^{N} a_{n} \bigg[ e^{i n \theta} + e^{-i n \theta}\bigg] = \\[0.5em] 
% &= \dfrac{1}{2} \bigg[ \nsum_{n=0}^{N} a_{n} \, e^{i n \theta} + \nsum_{n=-N}^{0} a_{-n} \, e^{i n \theta} \bigg] = \\[0.5em]
% &= \nsum_{n=-N}^{N} C_{n} \, e^{i n \theta}
% \end{align*}
% donde:
% \begin{align*}
% C_{n} &= \dfrac{a_{n}}{2} \mbox{ para } n > 0 \\[0.5em]
% C_{n} &= \dfrac{a_{-n}}{2} \mbox{ para } n < 0 \\[0.5em]
% C_{0} &= a_{0}
% \end{align*}

% Ya que cualquier función trigonométrica de la forma:
% \begin{align*}
% \psi(\theta) = \nsum_{n=0}^{N} a_{n} \, \cos (n \, \theta) 
% \end{align*}
% Puede expresarse en términos de las funciones:
% \begin{align*}
% \phi_{n}(\theta) = \dfrac{e^{i n \theta}}{\sqrt{2}}
% \end{align*}
% intentemos usar este conjunto de funciones $\phi_{n}(\theta)$ como una base.
% \par
% Como el conjunto de las $\phi_{n}(\theta)$ es completo,  veamos si es ortonormal. Evaluemos el producto escalar $\ip{\phi_{m}}{\phi_{n}}$.
% \begin{align*}
% \ip{\phi_{m}}{\phi_{n}} &= \scaleint{6ex}_{\bs - \pi}^{\pi} \phi_{m}^{*} (\theta) \, \phi_{n} (\theta) \dd{\theta} = \\[0.5em] 
% &= \dfrac{1}{2 \, \pi} \scaleint{6ex}_{\bs - \pi}^{\pi} \exp(i (n -m )\theta) \dd{\theta} &= \\[0.5em] 
% &= \delta_{nm}
% \end{align*}

% Llegando a este resultado, debemos de considerar dos casos:
% \begin{enumerate}[label=\roman*)]
% \item $n = m$
% \item $n \neq m$
% \end{enumerate}

% \textbf{\texttt{i) }} En el primer caso: $n = m$, es obvio que:
% \begin{align*}
% \ip{\phi_{m}}{\phi_{n}} &= \dfrac{1}{2 \, \pi} \scaleint{6ex}_{\bs - \pi}^{\pi} \dd{\theta} = \\[0.5em] 
% &= 1
% \end{align*}

% \textbf{\texttt{ii) }} En el segundo caso: $n \neq m$, se tiene que:
% \begin{align*}
% \ip{\phi_{m}}{\phi_{n}} &= \dfrac{1}{2 \, \pi} \scaleint{6ex}_{\bs - \pi}^{\pi} \exp(i(n - m) \theta) \dd{\theta} = \\[0.5em] 
% &= \dfrac{1}{2 \, \pi} \, \dfrac{\exp(i(n - m) \pi) - \exp(-i(n - m) \pi)}{i (n - m)} = \\[0.5em] 
% &= \dfrac{2 \, i \, \sin \big( \big[ n - m \big] \, \pi \big) }{2 \, i \, \pi \, (n - m)} = \\[0.5em] 
% &= 0
% \end{align*}

% Por lo que el conjunto de funciones:
% \begin{align*}
% \phi_{n}(\theta) = \dfrac{e^{i n \theta}}{\sqrt{2}}
% \end{align*}
% forman una base completa y ortonormal.
% \par
% Del resultado:
% \begin{align*}
% \nsum_{n=-N}^{N} C_{n} \, e^{i n \theta}
% \end{align*}
% vemos que la base tiene $2 \, N + 1$ funciones $\phi_{n}(\theta)$, por lo que la dimensión de este espacio de funciones es igual a $2 \, N + 1$.
% \par
% Una vez que ya tenemos la expresión para la base ortonormal, podemos calcular los vectores base.
% \par
% Con $N = 5$, se tiene que la dimensión del espacio es igual a $11$,  por lo que la base tiene $11$ vectores.
% \begin{align*}
% \phi_{-5} (\theta) &= \exp(- 5 \, i \, \theta) / \sqrt{2 \, \pi} \\[0.5em]
% \phi_{-4} (\theta) &= \exp(- 4 \, i \, \theta) / \sqrt{2 \, \pi} \\[0.5em]
% \vdots \\[0.5em]
% \phi_{0} (\theta) &= 1 / \sqrt{2 \, \pi} \\[0.5em]
% \vdots \\[0.5em]
% \phi_{4} (\theta) &= \exp(4 \, i \, \theta) / \sqrt{2 \, \pi} \\[0.5em]
% \phi_{5} (\theta) &= \exp(5 \, i \, \theta) / \sqrt{2 \, \pi} \\
% \end{align*}

\end{document}